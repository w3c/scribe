#!/bin/bash
#
# Test the "-help" option.

trap 'rm -f $TMP1 $TMP2 $TMP3 $TMP4' 0
TMP1=`mktemp /tmp/out-XXXXXX` || exit 1
TMP2=`mktemp /tmp/err-XXXXXX` || exit 1
TMP3=`mktemp /tmp/err-XXXXXX` || exit 1
TMP4=`mktemp /tmp/err-XXXXXX` || exit 1

cat >$TMP3 <<EOF
<html><head><title>Scribe.perl: Fatal error</title></head>
<body><h1>Scribe.perl: Fatal error</h1>
<pre>
For help, see http://dev.w3.org/cvsweb/%7Echeckout%7E/2002/scribe/scribedoc.htm

</pre>
</body>
</html>
EOF

cat >$TMP4 <<EOF
For help, see http://dev.w3.org/cvsweb/%7Echeckout%7E/2002/scribe/scribedoc.htm
EOF

perl scribe.perl -help >$TMP1 2>$TMP2

diff -u \
  <(grep -v 'This is scribe.perl ' $TMP1) \
  <(grep -v 'This is scribe.perl ' $TMP3) || exit 1

diff -u $TMP2 $TMP4 || exit 1
